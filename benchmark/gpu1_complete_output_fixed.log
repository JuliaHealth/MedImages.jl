   Resolving package versions...
  No Changes to `/workspaces/MedImages.jl/benchmark/Project.toml`
  No Changes to `/workspaces/MedImages.jl/benchmark/Manifest.toml`
   Resolving package versions...
  No Changes to `/workspaces/MedImages.jl/benchmark/Project.toml`
  No Changes to `/workspaces/MedImages.jl/benchmark/Manifest.toml`
   Resolving package versions...
  No Changes to `/workspaces/MedImages.jl/benchmark/Project.toml`
  No Changes to `/workspaces/MedImages.jl/benchmark/Manifest.toml`
  Activating project at `/workspaces/MedImages.jl`
  Activating project at `/workspaces/MedImages.jl/benchmark`
CUDA available: NVIDIA GeForce RTX 3090
CUDA memory: 23 GB
================================================================================
MedImages.jl GPU Benchmark Suite
================================================================================
Start time: 2026-01-23T10:01:22.816

================================================================================
Benchmark Configuration
================================================================================

Image Sizes:
  xlarge: 1024 x 1024 x 512
  large: 512 x 512 x 256
  small: 128 x 128 x 64
  medium: 256 x 256 x 128

Interpolation Methods:
  - Nearest Neighbor
  - Linear

Spacing Configurations:
  anisotropic_ct: 0.7 x 0.7 x 5.0 mm
  anisotropic_mri: 1.0 x 1.0 x 3.0 mm
  isotropic: 1.0 x 1.0 x 1.0 mm

Resampling Factors:
  downsample_2x: 0.5x
  upsample_1_5x: 1.5x
  downsample_4x: 0.25x

Point Counts: 100000, 1000000

Backends:
  - CPU (GPU: false)
  - CUDA (GPU: true)

Benchmark Settings:
  Samples: 10
  Min time: 2.0s
  Warmup iterations: 3

Output:
  Results directory: benchmark_results
  Compare SimpleITK: true
================================================================================
Creating synthetic test images...
  Creating xlarge image: 1024x1024x512
  Creating large image: 512x512x256
  Creating medium image: 256x256x128

================================================================================
Starting Benchmark Suite
================================================================================
Operations: all
Backends: cuda
================================================================================

================================================================================
Image Size: xlarge (1024x1024x512)
================================================================================

--------------------------------------------------------------------------------
Backend: CUDA
--------------------------------------------------------------------------------

### Interpolation Kernel Benchmarks ###

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.028 ms (median), 0.041 ms (mean), 0.028 ms (std)
  Throughput: 3.63e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.153 ms (median), 0.207 ms (mean), 0.174 ms (std)
  Throughput: 6.55e+08 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.172 ms (median), 0.201 ms (mean), 0.067 ms (std)
  Throughput: 5.81e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.853 ms (median), 0.839 ms (mean), 0.062 ms (std)
  Throughput: 1.17e+09 points/sec
  Memory: 0.0 MB

### Resampling Benchmarks ###

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 1024x1024x512
  Output dims: 512x512x256
  Time: 2.974 ms (median), 2.998 ms (mean), 0.099 ms (std)
  Throughput: 1.81e+11 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 1024x1024x512
  Output dims: 512x512x256
  Time: 4.344 ms (median), 4.385 ms (mean), 0.079 ms (std)
  Throughput: 1.24e+11 voxels/sec
  Memory: 0.0 MB
  Skipping upsampling (upsample_1_5x) for xlarge to avoid OOM

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 1024x1024x512
  Output dims: 256x256x128
  Time: 0.374 ms (median), 0.386 ms (mean), 0.030 ms (std)
  Throughput: 1.44e+12 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 1024x1024x512
  Output dims: 256x256x128
  Time: 0.686 ms (median), 0.694 ms (mean), 0.034 ms (std)
  Throughput: 7.82e+11 voxels/sec
  Memory: 0.0 MB

### Rotation Benchmarks ###

Benchmarking rotate_mi: CUDA backend, 90 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 60036.984 ms (median), 60036.984 ms (mean), NaN ms (std)
  Throughput: 8.94e+06 voxels/sec
  Memory: 83968.0 MB

Benchmarking rotate_mi: CUDA backend, 180 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 61144.871 ms (median), 61144.871 ms (mean), NaN ms (std)
  Throughput: 8.78e+06 voxels/sec
  Memory: 83968.0 MB

Benchmarking rotate_mi: CUDA backend, 270 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 59341.465 ms (median), 59341.465 ms (mean), NaN ms (std)
  Throughput: 9.05e+06 voxels/sec
  Memory: 83968.0 MB

### Crop Benchmarks ###

Benchmarking crop_mi: CUDA backend, 10.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 6.45e+14 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 50.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 6.45e+14 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 30.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 6.18e+14 voxels/sec
  Memory: 0.0 MB

### Pad Benchmarks (skipped - CUDA scalar indexing not supported) ###

### Orientation Change Benchmarks ###

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_LAS
  Running benchmark...
  Time: 5.550 ms (median), 5.582 ms (mean), 0.194 ms (std)
  Throughput: 9.67e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RAS
  Running benchmark...
  Time: 5.646 ms (median), 5.666 ms (mean), 0.141 ms (std)
  Throughput: 9.51e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RPI
  Running benchmark...
  Time: 5.558 ms (median), 5.651 ms (mean), 0.164 ms (std)
  Throughput: 9.66e+10 voxels/sec
  Memory: 0.0 MB

================================================================================
Image Size: large (512x512x256)
================================================================================

--------------------------------------------------------------------------------
Backend: CUDA
--------------------------------------------------------------------------------

### Interpolation Kernel Benchmarks ###

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.026 ms (median), 0.037 ms (mean), 0.031 ms (std)
  Throughput: 3.85e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.285 ms (median), 0.304 ms (mean), 0.165 ms (std)
  Throughput: 3.51e+08 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.163 ms (median), 0.187 ms (mean), 0.052 ms (std)
  Throughput: 6.15e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.745 ms (median), 0.768 ms (mean), 0.058 ms (std)
  Throughput: 1.34e+09 points/sec
  Memory: 0.0 MB

### Resampling Benchmarks ###

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 256x256x128
  Time: 0.375 ms (median), 0.388 ms (mean), 0.037 ms (std)
  Throughput: 1.79e+11 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 256x256x128
  Time: 0.598 ms (median), 0.642 ms (mean), 0.099 ms (std)
  Throughput: 1.12e+11 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, upsample 1.50x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 768x768x384
  Time: 9.746 ms (median), 9.769 ms (mean), 0.065 ms (std)
  Throughput: 6.89e+09 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, upsample 1.50x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 768x768x384
  Time: 14.638 ms (median), 14.635 ms (mean), 0.058 ms (std)
  Throughput: 4.58e+09 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 128x128x64
  Time: 0.056 ms (median), 0.067 ms (mean), 0.023 ms (std)
  Throughput: 1.20e+12 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 512x512x256
  Output dims: 128x128x64
  Time: 0.099 ms (median), 0.137 ms (mean), 0.099 ms (std)
  Throughput: 6.76e+11 voxels/sec
  Memory: 0.0 MB

### Rotation Benchmarks ###

Benchmarking rotate_mi: CUDA backend, 90 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 7692.070 ms (median), 7692.070 ms (mean), NaN ms (std)
  Throughput: 8.72e+06 voxels/sec
  Memory: 10496.0 MB

Benchmarking rotate_mi: CUDA backend, 180 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 7919.166 ms (median), 7919.166 ms (mean), NaN ms (std)
  Throughput: 8.47e+06 voxels/sec
  Memory: 10496.0 MB

Benchmarking rotate_mi: CUDA backend, 270 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 7677.887 ms (median), 7677.887 ms (mean), NaN ms (std)
  Throughput: 8.74e+06 voxels/sec
  Memory: 10496.0 MB

### Crop Benchmarks ###

Benchmarking crop_mi: CUDA backend, 10.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 8.01e+13 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 50.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 7.90e+13 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 30.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 7.98e+13 voxels/sec
  Memory: 0.0 MB

### Pad Benchmarks (skipped - CUDA scalar indexing not supported) ###

### Orientation Change Benchmarks ###

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_LAS
  Running benchmark...
  Time: 0.713 ms (median), 0.754 ms (mean), 0.084 ms (std)
  Throughput: 9.42e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RAS
  Running benchmark...
  Time: 0.807 ms (median), 0.799 ms (mean), 0.071 ms (std)
  Throughput: 8.31e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RPI
  Running benchmark...
  Time: 0.744 ms (median), 0.757 ms (mean), 0.064 ms (std)
  Throughput: 9.02e+10 voxels/sec
  Memory: 0.0 MB

================================================================================
Image Size: medium (256x256x128)
================================================================================

--------------------------------------------------------------------------------
Backend: CUDA
--------------------------------------------------------------------------------

### Interpolation Kernel Benchmarks ###

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.023 ms (median), 0.045 ms (mean), 0.069 ms (std)
  Throughput: 4.30e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 100000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.072 ms (median), 0.095 ms (mean), 0.056 ms (std)
  Throughput: 1.38e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.154 ms (median), 0.168 ms (mean), 0.037 ms (std)
  Throughput: 6.50e+09 points/sec
  Memory: 0.0 MB

Benchmarking interpolate_kernel: CUDA backend, 1000000 points, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 0.696 ms (median), 0.699 ms (mean), 0.060 ms (std)
  Throughput: 1.44e+09 points/sec
  Memory: 0.0 MB

### Resampling Benchmarks ###

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 128x128x64
  Time: 0.056 ms (median), 0.074 ms (mean), 0.056 ms (std)
  Throughput: 1.50e+11 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.50x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 128x128x64
  Time: 0.092 ms (median), 0.114 ms (mean), 0.048 ms (std)
  Throughput: 9.16e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, upsample 1.50x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 384x384x192
  Time: 1.300 ms (median), 1.308 ms (mean), 0.053 ms (std)
  Throughput: 6.45e+09 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, upsample 1.50x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 384x384x192
  Time: 2.045 ms (median), 2.046 ms (mean), 0.015 ms (std)
  Throughput: 4.10e+09 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Nearest interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 64x64x32
  Time: 0.017 ms (median), 0.040 ms (mean), 0.071 ms (std)
  Throughput: 5.00e+11 voxels/sec
  Memory: 0.0 MB

Benchmarking resample_to_spacing: CUDA backend, downsample 0.25x, Linear interpolation
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Input dims: 256x256x128
  Output dims: 64x64x32
  Time: 0.023 ms (median), 0.045 ms (mean), 0.067 ms (std)
  Throughput: 3.65e+11 voxels/sec
  Memory: 0.0 MB

### Rotation Benchmarks ###

Benchmarking rotate_mi: CUDA backend, 90 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 1014.112 ms (median), 1014.112 ms (mean), 8.278 ms (std)
  Throughput: 8.27e+06 voxels/sec
  Memory: 1312.0 MB

Benchmarking rotate_mi: CUDA backend, 180 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 1026.068 ms (median), 1026.068 ms (mean), 8.909 ms (std)
  Throughput: 8.18e+06 voxels/sec
  Memory: 1312.0 MB

Benchmarking rotate_mi: CUDA backend, 270 degrees
Warming up GPU...
  GPU warmed up
  Running benchmark...
  Time: 1018.854 ms (median), 1018.854 ms (mean), 4.662 ms (std)
  Throughput: 8.23e+06 voxels/sec
  Memory: 1312.0 MB

### Crop Benchmarks ###

Benchmarking crop_mi: CUDA backend, 10.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 9.99e+12 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 50.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 9.79e+12 voxels/sec
  Memory: 0.0 MB

Benchmarking crop_mi: CUDA backend, 30.0% crop
  Running benchmark...
  Time: 0.001 ms (median), 0.001 ms (mean), 0.000 ms (std)
  Throughput: 9.91e+12 voxels/sec
  Memory: 0.0 MB

### Pad Benchmarks (skipped - CUDA scalar indexing not supported) ###

### Orientation Change Benchmarks ###

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_LAS
  Running benchmark...
  Time: 0.102 ms (median), 0.137 ms (mean), 0.080 ms (std)
  Throughput: 8.22e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RAS
  Running benchmark...
  Time: 0.097 ms (median), 0.110 ms (mean), 0.035 ms (std)
  Throughput: 8.65e+10 voxels/sec
  Memory: 0.0 MB

Benchmarking change_orientation: CUDA backend, target: ORIENTATION_RPI
  Running benchmark...
  Time: 0.117 ms (median), 0.184 ms (mean), 0.123 ms (std)
  Throughput: 7.20e+10 voxels/sec
  Memory: 0.0 MB

================================================================================
Memory Transfer Benchmarks
================================================================================

Benchmarking memory transfer: (1024, 1024, 512)
  CPU -> GPU transfer...
    Time: 171.909 ms (median)
    Transfer rate: 11913.28 MB/s
  GPU -> CPU transfer...
    Time: 860.442 ms (median)
    Transfer rate: 2380.17 MB/s

================================================================================
Generating Reports
================================================================================
Results saved to: gpu1_benchmarks_fixed/results.csv
Report saved to: gpu1_benchmarks_fixed/report.md

================================================================================
Benchmark Summary
================================================================================

Total benchmarks run: 55
  Interpolation: 12
  Resampling: 16
  Rotation: 9
  Crop: 9
  Orientation: 9

Average CUDA Speedups:
================================================================================

================================================================================
Benchmark Visualization
================================================================================

================================================================================
SimpleITK Comparison
================================================================================

================================================================================
SimpleITK Comparison Benchmarks
================================================================================
┌ Warning: SimpleITK comparison failed
│   exception = type Array has no field voxel_data
└ @ Main /workspaces/MedImages.jl/benchmark/benchmark_utils.jl:336
SimpleITK comparison skipped due to error

================================================================================
Benchmark Complete!
================================================================================
End time: 2026-01-23T10:15:03.721
Results saved to: gpu1_benchmarks_fixed
  - CSV: gpu1_benchmarks_fixed/results.csv
  - Report: gpu1_benchmarks_fixed/report.md
================================================================================
